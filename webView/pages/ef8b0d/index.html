<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>new Function | 阿誉的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog/favicon.ico">
    <meta name="description" content="刘誉的博客">
    <meta name="keywords" content="vuepress,vuepress-theme,theme,docs of vuepress,主题,vuepress主题,个人博客,blog,vuepress-blog,github">
    <link rel="preload" href="/blog/assets/css/0.styles.6cb6fcc7.css" as="style"><link rel="preload" href="/blog/assets/js/app.24a1d4ba.js" as="script"><link rel="preload" href="/blog/assets/js/2.a6dfd479.js" as="script"><link rel="preload" href="/blog/assets/js/26.c17442cc.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.33cbd9fe.js"><link rel="prefetch" href="/blog/assets/js/11.b37c6198.js"><link rel="prefetch" href="/blog/assets/js/12.92bb507e.js"><link rel="prefetch" href="/blog/assets/js/13.a10fc85c.js"><link rel="prefetch" href="/blog/assets/js/14.d2486333.js"><link rel="prefetch" href="/blog/assets/js/15.c045b0ac.js"><link rel="prefetch" href="/blog/assets/js/16.66fc0c96.js"><link rel="prefetch" href="/blog/assets/js/17.bc0c6963.js"><link rel="prefetch" href="/blog/assets/js/18.01b2ba92.js"><link rel="prefetch" href="/blog/assets/js/19.874d2360.js"><link rel="prefetch" href="/blog/assets/js/20.888a678b.js"><link rel="prefetch" href="/blog/assets/js/21.d7f7cde7.js"><link rel="prefetch" href="/blog/assets/js/22.bc024542.js"><link rel="prefetch" href="/blog/assets/js/23.1d45ed73.js"><link rel="prefetch" href="/blog/assets/js/24.8408dd18.js"><link rel="prefetch" href="/blog/assets/js/25.1e256f42.js"><link rel="prefetch" href="/blog/assets/js/27.18ae01f5.js"><link rel="prefetch" href="/blog/assets/js/28.c862809e.js"><link rel="prefetch" href="/blog/assets/js/29.29e0d35c.js"><link rel="prefetch" href="/blog/assets/js/3.9c7ab74d.js"><link rel="prefetch" href="/blog/assets/js/30.ce294269.js"><link rel="prefetch" href="/blog/assets/js/31.f2151fea.js"><link rel="prefetch" href="/blog/assets/js/32.9bcb255a.js"><link rel="prefetch" href="/blog/assets/js/33.aa02db46.js"><link rel="prefetch" href="/blog/assets/js/34.e284718b.js"><link rel="prefetch" href="/blog/assets/js/35.1fa4da48.js"><link rel="prefetch" href="/blog/assets/js/36.d13e2af1.js"><link rel="prefetch" href="/blog/assets/js/37.043832a3.js"><link rel="prefetch" href="/blog/assets/js/38.55bd46ae.js"><link rel="prefetch" href="/blog/assets/js/39.3d3e1580.js"><link rel="prefetch" href="/blog/assets/js/4.12f05b2d.js"><link rel="prefetch" href="/blog/assets/js/40.7938e899.js"><link rel="prefetch" href="/blog/assets/js/41.5ca8a13d.js"><link rel="prefetch" href="/blog/assets/js/42.06dfcd38.js"><link rel="prefetch" href="/blog/assets/js/43.49f308fc.js"><link rel="prefetch" href="/blog/assets/js/44.fda6bedb.js"><link rel="prefetch" href="/blog/assets/js/45.1a00eb55.js"><link rel="prefetch" href="/blog/assets/js/46.7964bbdb.js"><link rel="prefetch" href="/blog/assets/js/47.a0441ccf.js"><link rel="prefetch" href="/blog/assets/js/5.1a423426.js"><link rel="prefetch" href="/blog/assets/js/6.cf6d06a3.js"><link rel="prefetch" href="/blog/assets/js/7.f58d02c2.js"><link rel="prefetch" href="/blog/assets/js/8.87b5e657.js"><link rel="prefetch" href="/blog/assets/js/9.4c55f0a3.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.6cb6fcc7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">阿誉的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端总结" class="dropdown-title"><a href="/blog/web/" class="link-title">前端总结</a> <span class="title" style="display:none;">前端总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/ccbe33/" class="nav-link">JavaScript基础</a></li><li class="dropdown-subitem"><a href="/blog/pages/6abe86/" class="nav-link">构造函数和原型</a></li><li class="dropdown-subitem"><a href="/blog/pages/255011/" class="nav-link">Cookie和Session</a></li><li class="dropdown-subitem"><a href="/blog/pages/6abety/" class="nav-link">Object.create(null)和{}</a></li><li class="dropdown-subitem"><a href="/blog/pages/0bea56/" class="nav-link">TypeScript配置</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/bd32c8/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/blog/pages/8ec53a/" class="nav-link">Vue-Router</a></li><li class="dropdown-subitem"><a href="/blog/pages/eb7fff/" class="nav-link">React基础入门</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/58f0cb/" class="nav-link">Http协议</a></li><li class="dropdown-subitem"><a href="/blog/pages/42e039/" class="nav-link">跨域问题总结</a></li><li class="dropdown-subitem"><a href="/blog/pages/667146/" class="nav-link">Nginx</a></li><li class="dropdown-subitem"><a href="/blog/pages/fc6574/" class="nav-link">正则表达式</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/blog/note/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/82005c/" class="nav-link">分析Promise实现</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目积累" class="dropdown-title"><a href="/blog/project/" class="link-title">项目积累</a> <span class="title" style="display:none;">项目积累</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/33b18f/" class="nav-link">Vite快速搭建Vue3+TypeScript项目</a></li><li class="dropdown-subitem"><a href="/blog/pages/0feae5/" class="nav-link">Cordova打包Vue项目的问题</a></li><li class="dropdown-subitem"><a href="/blog/pages/500c71/" class="nav-link">Vue将汉字转为拼音，取出首字母</a></li></ul></li><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/ef8b0d/" aria-current="page" class="nav-link router-link-exact-active router-link-active">new Function</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/dbadd2/" class="nav-link">Node.js中使用Crypto生成Token</a></li><li class="dropdown-subitem"><a href="/blog/pages/7be537/" class="nav-link">Body-Parser处理多层对象的问题</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/00f068/" class="nav-link">项目Demo汇总</a></li><li class="dropdown-subitem"><a href="/blog/pages/1c0dd1/" class="nav-link">项目中能用到的</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/blog/fontend/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/e84bbd/" class="nav-link">Mongoose基础</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/71e997/" class="nav-link">Multer文件上传中间件的使用</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/blog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/e11b6a/" class="nav-link">浅谈两数全等</a></li><li class="dropdown-subitem"><a href="/blog/pages/bf9ebd/" class="nav-link">JavaScript进制转换</a></li></ul></li><li class="dropdown-item"><h4>算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/4c1d71/" class="nav-link">数组去重和排序</a></li><li class="dropdown-subitem"><a href="/blog/pages/50cab2/" class="nav-link">数组扁平化</a></li><li class="dropdown-subitem"><a href="/blog/pages/7e8314/" class="nav-link">斐波那契数列</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><a href="/blog/computer/" class="link-title">计算机</a> <span class="title" style="display:none;">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>计算机网络</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/3c0ea2/" class="nav-link">数据链路层</a></li><li class="dropdown-subitem"><a href="/blog/pages/20ac91/" class="nav-link">网络层</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="外链" class="dropdown-title"><!----> <span class="title" style="display:;">外链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/coderlyu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/163200" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatar-static.segmentfault.com/249/884/2498845138-602fc45007b7c_big64"> <div class="blogger-info"><h3>coderly</h3> <span>变秃了也变强了</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端总结" class="dropdown-title"><a href="/blog/web/" class="link-title">前端总结</a> <span class="title" style="display:none;">前端总结</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/ccbe33/" class="nav-link">JavaScript基础</a></li><li class="dropdown-subitem"><a href="/blog/pages/6abe86/" class="nav-link">构造函数和原型</a></li><li class="dropdown-subitem"><a href="/blog/pages/255011/" class="nav-link">Cookie和Session</a></li><li class="dropdown-subitem"><a href="/blog/pages/6abety/" class="nav-link">Object.create(null)和{}</a></li><li class="dropdown-subitem"><a href="/blog/pages/0bea56/" class="nav-link">TypeScript配置</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/bd32c8/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/blog/pages/8ec53a/" class="nav-link">Vue-Router</a></li><li class="dropdown-subitem"><a href="/blog/pages/eb7fff/" class="nav-link">React基础入门</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/58f0cb/" class="nav-link">Http协议</a></li><li class="dropdown-subitem"><a href="/blog/pages/42e039/" class="nav-link">跨域问题总结</a></li><li class="dropdown-subitem"><a href="/blog/pages/667146/" class="nav-link">Nginx</a></li><li class="dropdown-subitem"><a href="/blog/pages/fc6574/" class="nav-link">正则表达式</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/blog/note/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/82005c/" class="nav-link">分析Promise实现</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目积累" class="dropdown-title"><a href="/blog/project/" class="link-title">项目积累</a> <span class="title" style="display:none;">项目积累</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/33b18f/" class="nav-link">Vite快速搭建Vue3+TypeScript项目</a></li><li class="dropdown-subitem"><a href="/blog/pages/0feae5/" class="nav-link">Cordova打包Vue项目的问题</a></li><li class="dropdown-subitem"><a href="/blog/pages/500c71/" class="nav-link">Vue将汉字转为拼音，取出首字母</a></li></ul></li><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/ef8b0d/" aria-current="page" class="nav-link router-link-exact-active router-link-active">new Function</a></li></ul></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/dbadd2/" class="nav-link">Node.js中使用Crypto生成Token</a></li><li class="dropdown-subitem"><a href="/blog/pages/7be537/" class="nav-link">Body-Parser处理多层对象的问题</a></li></ul></li><li class="dropdown-item"><h4>其它</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/00f068/" class="nav-link">项目Demo汇总</a></li><li class="dropdown-subitem"><a href="/blog/pages/1c0dd1/" class="nav-link">项目中能用到的</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/blog/fontend/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/e84bbd/" class="nav-link">Mongoose基础</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/71e997/" class="nav-link">Multer文件上传中间件的使用</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><a href="/blog/interview/" class="link-title">面试</a> <span class="title" style="display:none;">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>JavaScript</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/e11b6a/" class="nav-link">浅谈两数全等</a></li><li class="dropdown-subitem"><a href="/blog/pages/bf9ebd/" class="nav-link">JavaScript进制转换</a></li></ul></li><li class="dropdown-item"><h4>算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/4c1d71/" class="nav-link">数组去重和排序</a></li><li class="dropdown-subitem"><a href="/blog/pages/50cab2/" class="nav-link">数组扁平化</a></li><li class="dropdown-subitem"><a href="/blog/pages/7e8314/" class="nav-link">斐波那契数列</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><a href="/blog/computer/" class="link-title">计算机</a> <span class="title" style="display:none;">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>计算机网络</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/3c0ea2/" class="nav-link">数据链路层</a></li><li class="dropdown-subitem"><a href="/blog/pages/20ac91/" class="nav-link">网络层</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="外链" class="dropdown-title"><!----> <span class="title" style="display:;">外链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/coderlyu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/163200" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/pages/00f068/" class="sidebar-link">项目 Demo 汇总</a></li><li><a href="/blog/pages/3d48b7/" class="sidebar-link">node中使用crypto生成token</a></li><li><a href="/blog/pages/ef8b0d/" aria-current="page" class="active sidebar-link">new Function</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#项目内容" class="sidebar-link">项目内容</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#任务需求" class="sidebar-link">任务需求</a></li><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#原代码" class="sidebar-link">原代码</a></li><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#原代码升级版" class="sidebar-link">原代码升级版</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#自己实现一个" class="sidebar-link">自己实现一个</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#分析" class="sidebar-link">分析</a></li><li class="sidebar-sub-header"><a href="/blog/pages/ef8b0d/#最终修改版" class="sidebar-link">最终修改版</a></li></ul></li></ul></li><li><a href="/blog/pages/7be537/" class="sidebar-link">body-parser处理多层对象的问题</a></li><li><a href="/blog/pages/33b18f/" class="sidebar-link">Vite快速搭建Vue3+TypeScript项目</a></li><li><a href="/blog/pages/0feae5/" class="sidebar-link">Cordova打包Vue项目的问题</a></li><li><a href="/blog/pages/500c71/" class="sidebar-link">Vue将汉字转为拼音，取出首字母</a></li><li><a href="/blog/pages/1c0dd1/" class="sidebar-link">项目中能用到的</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><a href="/blog/project" title="项目-目录页" data-v-33863c7e>项目</a></li> <!----> <!----></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="https://github.com/coderlyu" target="_blank" title="作者" class="beLink" data-v-33863c7e>coderly</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2020-05-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">
          new Function
        </h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="new-function"><a href="#new-function" class="header-anchor">#</a> new Function</h1> <p>最近在项目中看到个写的不错的函数实现，拿出来和大家一起分享分享</p> <h2 id="项目内容"><a href="#项目内容" class="header-anchor">#</a> 项目内容</h2> <h3 id="任务需求"><a href="#任务需求" class="header-anchor">#</a> 任务需求</h3> <ul><li>两个配置项，<code>prev</code>，和 <code>curr</code></li> <li>它们的结构可能是这样：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prev'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'想吃点东西'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'想出去玩'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> curr <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'curr'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'eat meat'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'play football'</span><span class="token punctuation">,</span>
    sleep<span class="token operator">:</span> <span class="token punctuation">{</span>
      time<span class="token operator">:</span> <span class="token string">'morning'</span><span class="token punctuation">,</span>
      place<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>我们发现它们有点像，但是数据又不同</li> <li>现在我们要实现一个 将 <code>curr</code> 的某些项（由你传入的参数决定）来更新 <code>prev</code> 的数据</li> <li>可能的情况：
<ol><li><code>prev</code> 有 <code>curr</code> 的属性，只是值不同</li> <li><code>prev</code> 里面没有 <code>curr</code> 的属性，这时我们要将该属性对应的值都 在 <code>prev</code> 上呈现</li></ol></li> <li>需要注意的是：我们这个操作并不是将 <code>curr</code> 里的内容和 <code>prev</code> 比较，有不同才更新到 <code>prev</code> 上，而是根据 用户 输入的 属性 ，将 <code>curr</code> 上对应的属性值更新到 <code>prev</code> 上</li></ul> <h3 id="原代码"><a href="#原代码" class="header-anchor">#</a> 原代码</h3> <ul><li>有改动</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setConf</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> fileds<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>fileds<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">第 3 个参数必须为一个数组</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> isFunc <span class="token operator">=</span> <span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fileds<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> key <span class="token operator">=</span> fileds<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> curr<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">属性</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的值为undefined</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    prev<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> isFunc <span class="token operator">?</span> <span class="token function">callback</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> curr<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> curr<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>【使用】：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prev'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'想吃点东西'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'想出去玩'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> curr <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'curr'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'eat meat'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'play football'</span><span class="token punctuation">,</span>
    sleep<span class="token operator">:</span> <span class="token punctuation">{</span>
      time<span class="token operator">:</span> <span class="token string">'morning'</span><span class="token punctuation">,</span>
      place<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token function">setConf</span><span class="token punctuation">(</span>prev<span class="token punctuation">.</span>lives<span class="token punctuation">,</span> curr<span class="token punctuation">.</span>lives<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'eat'</span><span class="token punctuation">,</span> <span class="token string">'sleep'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prev<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>结果<br> <img src="https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/new-function-1.png" alt="图片"></p> <p><strong>【分析】：</strong></p> <ul><li>我们看到上面的结果，我们将 <code>curr</code> 上的 <code>eat</code> 和 <code>sleep</code> 属性的值 更新到了 <code>prev</code> 上</li> <li><code>setConf(prev.lives, curr.lives, ['eat', 'sleep'])</code> 我们传入了 <code>prev.lives</code> 和 <code>curr.lives</code> , 意思是：我们需要将 <code>curr.lives</code> 的某写属性 更新到 <code>prev.lives</code> 上，而需要更新哪些内容，我们 第 3 个参数 <code>['eat', 'sleep']</code> 就是 需要更新的属性</li></ul> <h3 id="原代码升级版"><a href="#原代码升级版" class="header-anchor">#</a> 原代码升级版</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> func <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span>
    <span class="token string">'obj'</span><span class="token punctuation">,</span>
    <span class="token string">'value'</span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">return obj['</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;']['&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'] = value</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">''</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> func <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span>
    <span class="token string">'obj'</span><span class="token punctuation">,</span>
    <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">return obj['</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;']['&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">']</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">setConf</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> fileds<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>fileds<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">第 3 个参数必须为一个数组</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> isFunc <span class="token operator">=</span> <span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fileds<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> prevKey <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">let</span> currKey <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>fileds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      prevKey <span class="token operator">=</span> fileds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      currKey <span class="token operator">=</span> fileds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      prevKey <span class="token operator">=</span> currKey <span class="token operator">=</span> fileds<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> curr<span class="token punctuation">[</span>currKey<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">属性</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>currKey<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的值为undefined</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token function">setValue</span><span class="token punctuation">(</span>
      prev<span class="token punctuation">,</span>
      prevKey<span class="token punctuation">,</span>
      isFunc
        <span class="token operator">?</span> <span class="token function">callback</span><span class="token punctuation">(</span>prevKey<span class="token punctuation">,</span> <span class="token function">getValue</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> currKey<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token function">getValue</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> currKey<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><strong>【使用】：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prev'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'想吃点东西'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'想出去玩'</span><span class="token punctuation">,</span>
    sleep<span class="token operator">:</span> <span class="token punctuation">{</span>
      time<span class="token operator">:</span> <span class="token string">'old time'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> curr <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'curr'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'eat meat'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'play football'</span><span class="token punctuation">,</span>
    sleep<span class="token operator">:</span> <span class="token punctuation">{</span>
      time<span class="token operator">:</span> <span class="token string">'morning'</span><span class="token punctuation">,</span>
      place<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    newTime<span class="token operator">:</span> <span class="token string">'最新时间'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token function">setConf</span><span class="token punctuation">(</span>prev<span class="token punctuation">.</span>lives<span class="token punctuation">,</span> curr<span class="token punctuation">.</span>lives<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'eat'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'sleep.time'</span><span class="token punctuation">,</span> <span class="token string">'newTime'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prev<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li>结果<br> <img src="https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/new-function-2.png" alt="图片"></li></ul> <p><strong>【分析】：</strong></p> <ul><li>现在经过升级，<code>setConf</code> 第 <code>3</code> 个参数数组里面还可以是数组，里面的那个 数组的意思是：<code>['sleep.time', 'newTime']</code> ， 将 <code>prev.lives</code> 里的 <code>sleep.time</code> 设置为 <code>curr.lives</code> 里的 <code>newTime</code> 值</li> <li>这样该方法可以接受多个参数，并且 <code>prev</code> 里需要更新的属性 可以和 <code>curr</code> 里的属性不一样</li> <li>上面有一个缺陷，就是如果 <code>prev.lives</code> 对象里面 不存在 <code>sleep</code> 属性 是会报如下的错</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prev'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'想吃点东西'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'想出去玩'</span><span class="token punctuation">,</span>
    <span class="token comment">// 删除 sleep 属性</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> curr <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'curr'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'eat meat'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'play football'</span><span class="token punctuation">,</span>
    sleep<span class="token operator">:</span> <span class="token punctuation">{</span>
      time<span class="token operator">:</span> <span class="token string">'morning'</span><span class="token punctuation">,</span>
      place<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    newTime<span class="token operator">:</span> <span class="token string">'最新时间'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token function">setConf</span><span class="token punctuation">(</span>prev<span class="token punctuation">.</span>lives<span class="token punctuation">,</span> curr<span class="token punctuation">.</span>lives<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'eat'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'sleep.time'</span><span class="token punctuation">,</span> <span class="token string">'newTime'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prev<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li>结果<br> <img src="https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/new-function-3.png" alt="图片"></li></ul> <h2 id="自己实现一个"><a href="#自己实现一个" class="header-anchor">#</a> 自己实现一个</h2> <ul><li>对于此前没有用过 <code>new Function</code> 创建过函数的我来说，我第一眼看到这个的使用就开始百度</li> <li><code>new Function( 'obj', 'value', return obj['${key.split('.').join(&quot;']['&quot;)}'] = value )</code> 特别是 <code>return</code> 后面的内容，还真得找个例子模拟运行一遍才能看懂</li> <li>所以花了点时间在思考，可不可以用我自己的方法实现一个类似的功能</li></ul> <h3 id="分析"><a href="#分析" class="header-anchor">#</a> 分析</h3> <h4 id="getvalue"><a href="#getvalue" class="header-anchor">#</a> <code>getValue</code></h4> <ul><li>该方法就是通过 不断对一个 <code>对象</code> 类型的数据，通过 <code>.</code> 取其对象的属性，直到最后你需要的那个 <code>属性</code> 对应的 <code>值</code></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prev'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'想吃点东西'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'想出去玩'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>比如上面这个，如果我要获取到 <code>play</code> 属性 对应的 值</li> <li>我们一般是通过 <code>prev.lives.play</code> 来获取</li> <li>如果对这个获取的过程进行拆分，可以总结如下：
<ol><li>首先获取 <code>lives</code> 的属性值：<code>let livesTmp = prev.lives</code></li> <li>然后通过上一步的值，再获取 <code>play</code> 的属性值： <code>let play = livesTmp.play</code></li></ol></li> <li>所以它的处理过程是，不断获取到 <code>上一个属性</code>对应的 <code>属性值</code> ，然后通过该 <code>属性值</code> 继续找 <code>下一个属性</code> 对应的 <code>属性值</code></li> <li>我们知道 数组的 <code>reduce</code> 方法，在回调函数中的第一个参数，是上一次处理返回的结果，第二个是当前的值。</li> <li>所以我们用 <code>reduce</code> 方法改写 <code>getValue</code> 函数实现，如下：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>加上错误处理：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    value <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">配置项</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>keys<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的值为undefined</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">配置项</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>keys<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的值为undefined</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> value
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="setvalue"><a href="#setvalue" class="header-anchor">#</a> <code>setValue</code></h4> <ul><li>我们借鉴上面的 <code>getValue</code> 的思路，<code>getValue</code> 是通过不断取属性值来取到你想获取的属性对应的值。</li> <li>那我们的 <code>setValue</code> 就是先通过查询当前属性有没有在 对象上，如果没有就添加，存在就查询 该属性值对应的下一个属性值，知道找到最后一个你要修改或者添加的属性和属性值。</li> <li>所以我们也通过 <code>reduce</code> 来改写 <code>setValue</code> 函数实现，如下：</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> key<span class="token punctuation">,</span> i<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>也可以用 如下不太好理解的写法，它和上面是等价的</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> key<span class="token punctuation">,</span> i<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">(</span>i <span class="token operator">===</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token punctuation">(</span>i <span class="token operator">!=</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span>
        <span class="token keyword">typeof</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="最终修改版"><a href="#最终修改版" class="header-anchor">#</a> 最终修改版</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> keys</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    value <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">配置项</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>keys<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的值为undefined</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">配置项</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>keys<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的值为undefined</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> value
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  keys<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pre<span class="token punctuation">,</span> key<span class="token punctuation">,</span> i<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">(</span>i <span class="token operator">===</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token punctuation">(</span>i <span class="token operator">!=</span> arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span>
        <span class="token keyword">typeof</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> pre<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">setConf</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> fileds<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isFunc <span class="token operator">=</span> <span class="token keyword">typeof</span> callback <span class="token operator">===</span> <span class="token string">'function'</span>
  <span class="token keyword">let</span> prevKey<span class="token punctuation">,</span> currKey
  fileds<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">keys<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    prevKey <span class="token operator">=</span> currKey <span class="token operator">=</span> keys
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      prevKey <span class="token operator">=</span> keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      currKey <span class="token operator">=</span> keys<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> pKey <span class="token operator">=</span> prevKey<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> cKey <span class="token operator">=</span> currKey<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> isFunc
      <span class="token operator">?</span> <span class="token function">callback</span><span class="token punctuation">(</span>pKey<span class="token punctuation">,</span> <span class="token function">getValue</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> currKey<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token operator">:</span> <span class="token function">getValue</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> currKey<span class="token punctuation">)</span>
    <span class="token function">setValue</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> prevKey<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> prev <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prev'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'想吃点东西'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'想出去玩'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  province<span class="token operator">:</span> <span class="token punctuation">{</span>
    newAddr<span class="token operator">:</span> <span class="token string">'浙江省'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> curr <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'curr'</span><span class="token punctuation">,</span>
  lives<span class="token operator">:</span> <span class="token punctuation">{</span>
    eat<span class="token operator">:</span> <span class="token string">'eat meat'</span><span class="token punctuation">,</span>
    play<span class="token operator">:</span> <span class="token string">'play football'</span><span class="token punctuation">,</span>
    sleep<span class="token operator">:</span> <span class="token punctuation">{</span>
      time<span class="token operator">:</span> <span class="token string">'morning'</span><span class="token punctuation">,</span>
      place<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  address<span class="token operator">:</span> <span class="token string">'xx省xx市xxx'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token function">setConf</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> curr<span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token string">'lives.eat'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'lives.sleep.time'</span><span class="token punctuation">,</span> <span class="token string">'lives.sleep.time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'province.newAddr'</span><span class="token punctuation">,</span> <span class="token string">'address'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prev<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br></div></div><p><strong>【结果】：</strong></p> <ul><li>这样我们通过 <code>setConf(prev, curr, ['lives.eat', ['lives.sleep.time', 'lives.sleep.time'], ['province.newAddr', 'address']])</code>，实现了追加不同属性并更新给出的属性<br> <img src="https://raw.githubusercontent.com/coderlyu/au-blog/master/docs/.vuepress/public/images/blogs/new-function-4.png" alt="图片"></li></ul></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/blog/tags/?tag=JavaScript" title="标签">#JavaScript</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/03/14, 10:54:27</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/blog/pages/3d48b7/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">node中使用crypto生成token</div></a> <a href="/blog/pages/7be537/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">body-parser处理多层对象的问题</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/pages/3d48b7/" class="prev">node中使用crypto生成token</a></span> <span class="next"><a href="/blog/pages/7be537/">body-parser处理多层对象的问题</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/pages/7e8314/"><div>斐波那契数列</div></a> <span>03-14</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/pages/50cab2/"><div>数组扁平化</div></a> <span>03-14</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/pages/4c1d71/"><div>数组去重和排序</div></a> <span>03-14</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2021
    <span>coderly | <a href="https://github.com/coderlyu" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/blog/assets/js/app.24a1d4ba.js" defer></script><script src="/blog/assets/js/2.a6dfd479.js" defer></script><script src="/blog/assets/js/26.c17442cc.js" defer></script>
  </body>
</html>