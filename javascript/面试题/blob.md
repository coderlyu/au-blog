# Blob
[参考](https://juejin.cn/post/6844903890228346894)

## 1. 基础概念类问题：
- **什么是 `Blob`？在前端开发中如何使用 `Blob`？**
  - 我期望你能解释 `Blob` (Binary Large Object) 是一种表示二进制数据的对象，并提到它常用于文件处理、上传或下载，以及如何通过 `Blob` 处理二进制数据。
  
- **`Blob` 与 `ArrayBuffer` 有什么区别？在什么情况下应该使用它们？**
  - 这里考察的是你对 `Blob` 和 `ArrayBuffer` 这两种处理二进制数据的对象的理解，尤其是在不同场景中的应用。

- **什么是 `ArrayBuffer`？它的主要用途是什么？**
  - 我期望你能解释 `ArrayBuffer` 是一个用来表示原始二进制数据的通用缓冲区，并提到它主要用于处理诸如流媒体、文件操作或 Web API 返回的二进制数据。

- **`ArrayBuffer` 与 `TypedArray` 之间的关系是什么？请简要解释常见的 `TypedArray` 类型。**
  - 这里考察你对 `TypedArray` (如 `Uint8Array`, `Int32Array`, `Float32Array` 等) 的理解，以及它们如何在 `ArrayBuffer` 上运作来处理不同类型的二进制数据。

## 2. 实践应用类问题：
- **如何将文本或 JSON 数据转换为 `Blob` 对象？然后如何通过 URL 下载该文件？**
  - 我期望你能写出将字符串数据转换为 `Blob` 的代码示例，并结合 `URL.createObjectURL()` 实现下载功能。

- **如何使用 `Blob` 来处理文件上传或图片预览？请给出示例。**
  - 此问题考察你是否能通过 `Blob` 实现文件处理的实际场景，例如文件上传前预览图片。

- **如何使用 `ArrayBuffer` 和 `TypedArray` 读取和修改二进制数据？请写出一个将二进制数据读取为 `Uint8Array` 并修改某个字节的示例。**
  - 我期望你能写出如何通过 `ArrayBuffer` 和 `TypedArray` 读取、操作二进制数据的代码，并展示如何通过索引直接修改二进制数据。

- **如何将一个 `ArrayBuffer` 转换为字符串或者将字符串转换为 `ArrayBuffer`？**
  - 考察你是否知道如何在二进制数据和字符串之间进行转换，常见方法包括使用 `TextEncoder` 和 `TextDecoder`。

- **当需要处理二进制文件（如图片或音频）时，如何使用 `ArrayBuffer` 和 `TypedArray` 进行操作？**
  - 此问题结合实际场景，考察你是否能够处理来自 API 或文件读取的二进制数据。


## 3. 进阶问题：
- **你如何将一个文件读取为 `ArrayBuffer`，并将其转换为 `Blob`？解释该过程中的每一步。**
  - 这个问题是为了考察你对二进制数据流的理解，以及如何在两者之间进行转换。

- **如何从 WebSocket 或 API 接收到的二进制数据流中创建并处理 `Blob` 对象？**
  - 这里是结合 WebSocket 使用场景，考察你处理二进制数据的能力，特别是在高并发情况下的 `Blob` 操作。

- **当处理大文件时，你如何有效地将文件分块处理（例如大于 1GB 的文件），并将其转换为 `Blob` 后进行上传？**
  - 该问题旨在评估你对大文件处理和内存管理的理解，包括如何将文件分块并通过 `Blob` 处理上传。

- **`DataView` 是什么？它与 `TypedArray` 有什么不同？在什么情况下应该使用 `DataView`？**
  - 这个问题考察你对更灵活的数据处理工具 `DataView` 的理解，特别是它如何允许对 `ArrayBuffer` 进行更复杂的、非定型的数据操作。

- **如何处理跨字节边界的数据（如将两个 8 位的字节合并为一个 16 位的整数）？**
  - 考察你在处理跨字节边界的数据时的能力，以及如何正确地使用 `TypedArray` 或 `DataView` 进行字节操作。

- **当从 WebSocket 或其他流式 API 接收二进制数据时，如何使用 `ArrayBuffer` 处理部分传输的数据？**
  - 此问题结合高并发或实时场景，考察你如何高效处理和拼接流式传输的二进制数据。

## 位(bit) 和字节(byte)

在 JavaScript 中，处理二进制数据时，位（bit）和字节（byte）相关的概念和操作非常重要。下面介绍相关的知识和常见操作：

### 1. **位与字节的基本概念**
- **位（bit）** 是计算机存储数据的最小单位，每个位可以是 `0` 或 `1`。
- **字节（byte）** 是由 8 位组成的存储单元，一个字节可以表示 256（2^8）种不同的值，即 0 到 255。
  
#### 位与字节的关系：
- 1 个字节 = 8 位。
- 字节用于表示更大的数据块，如字符、数字等。通常在处理文件、网络数据时，数据是以字节为单位传输和存储的。

### 2. **JavaScript中的二进制操作**
JavaScript 提供了一些位操作符，允许在较低层次上对二进制数据进行操作。常见的位操作符包括：

#### 位操作符：
- **按位与（&）**：对每一位执行 AND 操作，只有对应位同时为 1 时结果才为 1。
  ```javascript
  let result = 5 & 3; // 0101 & 0011 => 0001 (1)
  ```
  
- **按位或（|）**：对每一位执行 OR 操作，只要对应位有一个为 1，结果就为 1。
  ```javascript
  let result = 5 | 3; // 0101 | 0011 => 0111 (7)
  ```

- **按位异或（^）**：对每一位执行 XOR 操作，当且仅当对应位不同，结果为 1。
  ```javascript
  let result = 5 ^ 3; // 0101 ^ 0011 => 0110 (6)
  ```

- **按位非（~）**：对每一位取反，0 变 1，1 变 0。
  ```javascript
  let result = ~5; // ~0101 => 1010 (-6, 补码表示)
  ```

- **左移（<<）**：将位向左移动指定的位数，右边补 0。
  ```javascript
  let result = 5 << 1; // 0101 << 1 => 1010 (10)
  ```

- **右移（>>）**：将位向右移动指定的位数，左边补符号位（负数补 1，正数补 0）。
  ```javascript
  let result = 5 >> 1; // 0101 >> 1 => 0010 (2)
  ```

- **无符号右移（>>>）**：将位向右移动指定的位数，左边补 0（无论正负数）。
  ```javascript
  let result = -5 >>> 1; // 1111...1011 >>> 1 => 0111...1101 (2147483645)
  ```

### 3. **字节操作与 `ArrayBuffer`**
`ArrayBuffer` 是 JavaScript 中用于处理二进制数据的一种对象，通常以字节为单位存储数据。通过 `TypedArray` 或 `DataView` 可以访问和操作这些字节数据。

#### 示例：通过 `ArrayBuffer` 处理字节
```javascript
let buffer = new ArrayBuffer(4); // 创建一个 4 字节的缓冲区
let view = new Uint8Array(buffer); // 创建一个 8 位无符号整数视图

view[0] = 255; // 将第一个字节设置为 255（11111111）
view[1] = 128; // 第二个字节设置为 128（10000000）
console.log(view); // 输出 Uint8Array(4) [255, 128, 0, 0]
```

### 4. **字节顺序（Endianess）**
在处理二进制数据时，**字节顺序**（Endianess）是一个需要注意的问题，指的是多字节数据（如 16 位或 32 位整数）在内存中的排列顺序。
- **大端序（Big Endian）**：高位字节在前，低位字节在后。
- **小端序（Little Endian）**：低位字节在前，高位字节在后。

JavaScript 默认使用小端序，尤其在处理 `TypedArray` 或 `DataView` 时可以指定字节序：

```javascript
let buffer = new ArrayBuffer(4);
let view = new DataView(buffer);
view.setUint16(0, 0x1234, true); // 小端序
console.log(view.getUint16(0, true)); // 输出 0x1234
```

### 5. **常见的二进制数据应用**
- **处理文件数据**：通过 `FileReader` 读取文件为 `ArrayBuffer`，并使用 `TypedArray` 或 `DataView` 操作字节。
- **处理图片、音频、视频等多媒体文件**：通过 `Blob` 对象存储、传输和操作二进制数据。
- **与 Web API 的交互**：如通过 WebSocket 处理二进制流，或从 API 获取二进制数据进行处理。

### 6. **字节的位级操作**
在实际应用中，位操作可以用于优化数据处理，如压缩数据、标志位操作等。举例：
- **设置标志位**：
  ```javascript
  let flags = 0b0000; // 初始状态
  flags |= 0b0010; // 设置第二个标志位为 1
  console.log(flags); // 输出 0b0010 (2)
  ```

- **检查某个位是否为 1**：
  ```javascript
  let hasFlag = (flags & 0b0010) !== 0; // 检查第二个标志位是否为 1
  console.log(hasFlag); // 输出 true
  ```

通过这些位、字节相关的概念与操作，你可以在 JavaScript 中有效地处理二进制数据，优化性能和内存使用。